<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>قسم الإدارة - مستشفى الحياة الذكية</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js"></script>
</head>
<body class="bg-gray-100 min-h-screen">
  <div class="max-w-7xl mx-auto p-4">
    <div class="bg-white shadow-md rounded-lg p-6 mb-6">
      <h1 class="text-3xl font-bold text-center text-blue-800 mb-2">لوحة إدارة مستشفى الحياة الذكية</h1>
      <p class="text-center text-gray-600">عرض شامل لجميع المرضى في الأقسام المختلفة</p>
    </div>

    <div class="mb-4 flex justify-between items-center">
      <input type="text" id="searchInput" placeholder="ابحث باسم المريض..."
        class="w-1/2 p-2 border rounded-md shadow" />
    </div>

    <div class="overflow-x-auto">
      <table class="min-w-full bg-white rounded-md shadow text-sm text-right">
        <thead class="bg-blue-100">
          <tr>
            <th class="p-2">الاسم</th>
            <th class="p-2">العمر</th>
            <th class="p-2">القسم</th>
            <th class="p-2">الحالة</th>
            <th class="p-2">عرض الملف</th>
          </tr>
        </thead>
        <tbody id="patientsBody"></tbody>
      </table>
    </div>
  </div>

  <script>
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
      databaseURL: "https://YOUR_PROJECT_ID.firebaseio.com",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_PROJECT_ID.appspot.com",
      messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
      appId: "YOUR_APP_ID"
    };

    const app = firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    const departments = ['emergency', 'operations', 'icu', 'reception'];
    const patientsBody = document.getElementById('patientsBody');

    departments.forEach(dept => {
      const refPath = `patients/${dept}`;
      db.ref(refPath).once('value', snapshot => {
        snapshot.forEach(child => {
          const patient = child.val();
          const id = child.key;

          const row = document.createElement('tr');
          row.classList.add("border-b", "hover:bg-gray-100");
          row.innerHTML = `
            <td class="p-2">${patient.name || ''}</td>
            <td class="p-2">${patient.age || ''}</td>
            <td class="p-2">${dept}</td>
            <td class="p-2">${patient.status || ''}</td>
            <td class="p-2">
              <a href="patient.html?id=${id}" target="_blank" class="text-blue-600 underline">عرض</a>
            </td>
          `;
          patientsBody.appendChild(row);
        });
      });
    });

    document.getElementById('searchInput').addEventListener('input', function () {
      const query = this.value.toLowerCase();
      document.querySelectorAll('#patientsBody tr').forEach(row => {
        const name = row.children[0].textContent.toLowerCase();
        row.style.display = name.includes(query) ? '' : 'none';
      });
    });
  </script>
</body>
</html>
