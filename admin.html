<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø³ØªØ´ÙÙ‰</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
<!-- Firebase -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-app.js";
import { getDatabase, ref, onValue, remove, update, push, set, get, child } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-database.js";

// Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Firebase
const firebaseConfig = {
  apiKey: "AIzaSyArPFi04c_vDP5Gi8bM4pem_LuvMx_eJG0",
  authDomain: "hospital-project-e4b59.firebaseapp.com",
  databaseURL: "https://hospital-project-e4b59-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "hospital-project-e4b59",
  storageBucket: "hospital-project-e4b59.appspot.com",
  messagingSenderId: "974610606258",
  appId: "1:974610606258:web:71ce7d5d447bca4b4441ab"
};

// ØªÙ‡ÙŠØ¦Ø© Firebase
const app = initializeApp(firebaseConfig);
const db = getDatabase(app);
const dbRef = ref(db);

// Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¨ÙŠÙ† Ø§Ù„Ø£Ù‚Ø³Ø§Ù…
function setupNavigation() {
  const sections = document.querySelectorAll(".section");
  const navLinks = document.querySelectorAll(".nav-link");
  
  navLinks.forEach(link => {
    link.addEventListener("click", () => {
      sections.forEach(sec => sec.classList.add("hidden"));
      document.getElementById(link.dataset.target).classList.remove("hidden");
      
      navLinks.forEach(l => l.classList.remove("bg-blue-600", "text-white"));
      link.classList.add("bg-blue-600", "text-white");
    });
  });
}

// Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø±Ø¶Ù‰ - Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯
const patientManager = {
  init() {
    this.setupEventListeners();
    this.loadPatients();
    this.updateStats();
  },
  
  setupEventListeners() {
    const searchInput = document.getElementById("searchPatient");
    searchInput.addEventListener("input", () => this.handleSearch(searchInput.value));
    
    // Ø¥Ø¶Ø§ÙØ© Ù…Ø±ÙŠØ¶ Ø¬Ø¯ÙŠØ¯
    document.getElementById("addPatientBtn").addEventListener("click", () => this.addPatient());
  },
  
  loadPatients() {
    const patientsRef = ref(db, "patients");
    
    onValue(patientsRef, (snapshot) => {
      const data = snapshot.val();
      const patientsContainer = document.getElementById("patientsContainer");
      patientsContainer.innerHTML = "";
      
      if (data) {
        // ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ù„Ù‰ Ù…ØµÙÙˆÙØ©
        let allPatients = [];
        Object.entries(data).forEach(([department, patients]) => {
          Object.entries(patients).forEach(([id, patient]) => {
            allPatients.push({ id, department, ...patient });
          });
        });
        
        // ÙØ±Ø² Ø§Ù„Ù…Ø±Ø¶Ù‰ Ø­Ø³Ø¨ Ø§Ù„ØªØ§Ø±ÙŠØ® (Ø§Ù„Ø£Ø­Ø¯Ø« Ø£ÙˆÙ„Ø§Ù‹)
        allPatients.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
        
        this.renderPatients(allPatients);
        this.updateStats();
      } else {
        patientsContainer.innerHTML = `
          <div class="text-center py-8 text-gray-500">
            <i class="fas fa-user-injured text-4xl mb-3"></i>
            <p>Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø£ÙŠ Ù…Ø±Ø¶Ù‰ Ù…Ø³Ø¬Ù„ÙŠÙ† Ø­Ø§Ù„ÙŠØ§Ù‹</p>
          </div>
        `;
      }
    });
  },
  
  renderPatients(patients) {
    const patientsContainer = document.getElementById("patientsContainer");
    
    patients.forEach(patient => {
      const patientCard = document.createElement("div");
      patientCard.className = "bg-white rounded-lg shadow-md p-4 mb-4 hover:shadow-lg transition-shadow duration-300";
      
      // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù„ÙˆÙ† Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø±ÙŠØ¶
      let statusColor = "bg-blue-100 text-blue-800";
      if (patient.department === "emergency") {
        statusColor = "bg-red-100 text-red-800";
      } else if (patient.department === "surgery") {
        statusColor = "bg-yellow-100 text-yellow-800";
      } else if (patient.department === "pediatrics") {
        statusColor = "bg-green-100 text-green-800";
      }
      
      patientCard.innerHTML = `
        <div class="flex justify-between items-start">
          <div class="flex items-center">
            <div class="w-12 h-12 rounded-full bg-blue-100 flex items-center justify-center text-blue-600 mr-4">
              <i class="fas fa-user"></i>
            </div>
            <div>
              <h3 class="font-bold text-lg">${patient.name}</h3>
              <p class="text-gray-600 text-sm">${patient.age} Ø³Ù†Ø©</p>
            </div>
          </div>
          <span class="px-3 py-1 rounded-full text-xs font-semibold ${statusColor}">
            ${patient.department}
          </span>
        </div>
        
        <div class="mt-4 grid grid-cols-2 gap-2 text-sm">
          <div>
            <p class="text-gray-500">Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ:</p>
            <p>${patient.nid || "ØºÙŠØ± Ù…ØªÙˆÙØ±"}</p>
          </div>
          <div>
            <p class="text-gray-500">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:</p>
            <p>${patient.address || "ØºÙŠØ± Ù…ØªÙˆÙØ±"}</p>
          </div>
          <div>
            <p class="text-gray-500">Ø§Ù„Ø£Ù…Ø±Ø§Ø¶:</p>
            <p>${patient.diseases || "Ù„Ø§ ÙŠÙˆØ¬Ø¯"}</p>
          </div>
          <div>
            <p class="text-gray-500">Ø§Ù„Ø¯ÙƒØªÙˆØ±:</p>
            <p>${patient.doctors || "ØºÙŠØ± Ù…Ø­Ø¯Ø¯"}</p>
          </div>
        </div>
        
        <div class="mt-4 flex justify-between items-center">
          <div class="text-sm text-gray-500">
            <i class="far fa-clock mr-1"></i> ${new Date(patient.timestamp).toLocaleString("ar-EG")}
          </div>
          <div class="flex gap-2">
            <button class="viewPatientBtn bg-blue-500 text-white px-3 py-1 rounded text-sm hover:bg-blue-600" data-id="${patient.id}" data-department="${patient.department}">
              <i class="fas fa-eye mr-1"></i> Ø¹Ø±Ø¶
            </button>
            <button class="editPatientBtn bg-yellow-500 text-white px-3 py-1 rounded text-sm hover:bg-yellow-600" data-id="${patient.id}" data-department="${patient.department}">
              <i class="fas fa-edit mr-1"></i> ØªØ¹Ø¯ÙŠÙ„
            </button>
            <button class="deletePatientBtn bg-red-500 text-white px-3 py-1 rounded text-sm hover:bg-red-600" data-id="${patient.id}" data-department="${patient.department}">
              <i class="fas fa-trash mr-1"></i> Ø­Ø°Ù
            </button>
          </div>
        </div>
      `;
      
      patientsContainer.appendChild(patientCard);
    });
    
    this.attachPatientEvents();
  },
  
  handleSearch(query) {
    const patientCards = document.querySelectorAll("#patientsContainer > div");
    
    patientCards.forEach(card => {
      const name = card.querySelector("h3").textContent.toLowerCase();
      const nid = card.querySelectorAll("p")[1]?.textContent.toLowerCase() || "";
      
      const match = name.includes(query.toLowerCase()) || nid.includes(query.toLowerCase());
      card.style.display = match ? "block" : "none";
    });
  },
  
  attachPatientEvents() {
    // Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ø±ÙŠØ¶
    document.querySelectorAll(".viewPatientBtn").forEach(btn => {
      btn.addEventListener("click", () => {
        const id = btn.dataset.id;
        const dept = btn.dataset.department;
        
        get(child(dbRef, `patients/${dept}/${id}`)).then((snapshot) => {
          const patient = snapshot.val();
          if (patient) {
            Swal.fire({
              title: "ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ø±ÙŠØ¶",
              html: `
                <div class="text-right text-sm space-y-2">
                  <div class="flex items-center">
                    <span class="w-24 text-gray-500">Ø§Ù„Ø§Ø³Ù…:</span>
                    <span class="font-semibold">${patient.name}</span>
                  </div>
                  <div class="flex items-center">
                    <span class="w-24 text-gray-500">Ø§Ù„Ø¹Ù…Ø±:</span>
                    <span>${patient.age} Ø³Ù†Ø©</span>
                  </div>
                  <div class="flex items-center">
                    <span class="w-24 text-gray-500">Ø§Ù„Ù‚Ø³Ù…:</span>
                    <span>${patient.department}</span>
                  </div>
                  <div class="flex items-center">
                    <span class="w-24 text-gray-500">Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ:</span>
                    <span>${patient.nid || "ØºÙŠØ± Ù…ØªÙˆÙØ±"}</span>
                  </div>
                  <div class="flex items-center">
                    <span class="w-24 text-gray-500">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:</span>
                    <span>${patient.address || "ØºÙŠØ± Ù…ØªÙˆÙØ±"}</span>
                  </div>
                  <div class="flex items-center">
                    <span class="w-24 text-gray-500">Ø§Ù„Ø£Ù…Ø±Ø§Ø¶:</span>
                    <span>${patient.diseases || "Ù„Ø§ ÙŠÙˆØ¬Ø¯"}</span>
                  </div>
                  <div class="flex items-center">
                    <span class="w-24 text-gray-500">Ø§Ù„Ø¯ÙƒØªÙˆØ±:</span>
                    <span>${patient.doctors || "ØºÙŠØ± Ù…Ø­Ø¯Ø¯"}</span>
                  </div>
                  <div class="flex items-center">
                    <span class="w-24 text-gray-500">ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ³Ø¬ÙŠÙ„:</span>
                    <span>${new Date(patient.timestamp).toLocaleString("ar-EG")}</span>
                  </div>
                  
                  ${patient.visits ? `
                  <div class="mt-4">
                    <h4 class="font-bold mb-2">Ø§Ù„ÙƒØ´ÙˆÙ Ø§Ù„Ø·Ø¨ÙŠØ©:</h4>
                    <div class="border rounded p-2 bg-gray-50">
                      ${Object.entries(patient.visits).map(([visitId, visit]) => `
                        <div class="mb-2 pb-2 border-b">
                          <div class="flex justify-between">
                            <span class="font-semibold">${visit.doctor}</span>
                            <span class="text-sm text-gray-500">${new Date(visit.date).toLocaleString("ar-EG")}</span>
                          </div>
                          <p class="mt-1">${visit.notes || "Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ù„Ø§Ø­Ø¸Ø§Øª"}</p>
                        </div>
                      `).join('')}
                    </div>
                  </div>
                  ` : ''}
                </div>
              `,
              icon: "info",
              confirmButtonText: "Ø¥ØºÙ„Ø§Ù‚",
              width: "600px"
            });
          }
        });
      });
    });
    
    // ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø±ÙŠØ¶
    document.querySelectorAll(".editPatientBtn").forEach(btn => {
      btn.addEventListener("click", () => {
        const id = btn.dataset.id;
        const dept = btn.dataset.department;
        
        get(child(dbRef, `patients/${dept}/${id}`)).then((snapshot) => {
          const patient = snapshot.val();
          if (patient) {
            Swal.fire({
              title: "ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø±ÙŠØ¶",
              html: `
                <div class="space-y-3 text-right">
                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Ø§Ù„Ø§Ø³Ù…</label>
                    <input id="editPatientName" class="swal2-input" value="${patient.name}">
                  </div>
                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Ø§Ù„Ø¹Ù…Ø±</label>
                    <input id="editPatientAge" class="swal2-input" type="number" value="${patient.age}">
                  </div>
                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Ø§Ù„Ù‚Ø³Ù…</label>
                    <select id="editPatientDept" class="swal2-select">
                      <option value="emergency" ${patient.department === "emergency" ? "selected" : ""}>Ø·ÙˆØ§Ø±Ø¦</option>
                      <option value="internal" ${patient.department === "internal" ? "selected" : ""}>Ø¨Ø§Ø·Ù†Ø©</option>
                      <option value="surgery" ${patient.department === "surgery" ? "selected" : ""}>Ø¬Ø±Ø§Ø­Ø©</option>
                      <option value="pediatrics" ${patient.department === "pediatrics" ? "selected" : ""}>Ø£Ø·ÙØ§Ù„</option>
                    </select>
                  </div>
                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ</label>
                    <input id="editPatientNid" class="swal2-input" value="${patient.nid || ""}">
                  </div>
                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</label>
                    <input id="editPatientAddress" class="swal2-input" value="${patient.address || ""}">
                  </div>
                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Ø§Ù„Ø£Ù…Ø±Ø§Ø¶</label>
                    <input id="editPatientDiseases" class="swal2-input" value="${patient.diseases || ""}">
                  </div>
                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Ø§Ù„Ø¯ÙƒØªÙˆØ±</label>
                    <input id="editPatientDoctor" class="swal2-input" value="${patient.doctors || ""}">
                  </div>
                </div>
              `,
              preConfirm: () => {
                const name = document.getElementById("editPatientName").value;
                const age = document.getElementById("editPatientAge").value;
                const department = document.getElementById("editPatientDept").value;
                const nid = document.getElementById("editPatientNid").value;
                const address = document.getElementById("editPatientAddress").value;
                const diseases = document.getElementById("editPatientDiseases").value;
                const doctor = document.getElementById("editPatientDoctor").value;
                
                if (!name || !age || !department) {
                  Swal.showValidationMessage("Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„Ø¹Ù…Ø± ÙˆØ§Ù„Ù‚Ø³Ù… Ù…Ø·Ù„ÙˆØ¨ÙˆÙ†");
                  return false;
                }
                
                update(child(dbRef, `patients/${dept}/${id}`), {
                  name, age, department, nid, address, diseases, doctors: doctor
                });
              }
            }).then(result => {
              if (result.isConfirmed) Swal.fire("ØªÙ…", "ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø±ÙŠØ¶ Ø¨Ù†Ø¬Ø§Ø­", "success");
            });
          }
        });
      });
    });
    
    // Ø­Ø°Ù Ø§Ù„Ù…Ø±ÙŠØ¶
    document.querySelectorAll(".deletePatientBtn").forEach(btn => {
      btn.addEventListener("click", () => {
        const id = btn.dataset.id;
        const dept = btn.dataset.department;
        
        Swal.fire({
          title: "Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ØŸ",
          text: "Ø³ÙŠØªÙ… Ø­Ø°Ù Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø±ÙŠØ¶ Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹",
          icon: "warning",
          showCancelButton: true,
          confirmButtonText: "Ù†Ø¹Ù…ØŒ Ø§Ø­Ø°Ù",
          cancelButtonText: "Ø¥Ù„ØºØ§Ø¡",
          confirmButtonColor: "#ef4444"
        }).then((result) => {
          if (result.isConfirmed) {
            remove(child(dbRef, `patients/${dept}/${id}`))
              .then(() => Swal.fire("ØªÙ…", "ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ø±ÙŠØ¶ Ø¨Ù†Ø¬Ø§Ø­", "success"))
              .catch(() => Swal.fire("Ø®Ø·Ø£", "ÙØ´Ù„ Ø§Ù„Ø­Ø°Ù", "error"));
          }
        });
      });
    });
  },
  
  addPatient() {
    Swal.fire({
      title: "Ø¥Ø¶Ø§ÙØ© Ù…Ø±ÙŠØ¶ Ø¬Ø¯ÙŠØ¯",
      html: `
        <div class="space-y-3 text-right">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Ø§Ù„Ø§Ø³Ù…</label>
            <input id="newPatientName" class="swal2-input" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø±ÙŠØ¶">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Ø§Ù„Ø¹Ù…Ø±</label>
            <input id="newPatientAge" class="swal2-input" type="number" placeholder="Ø£Ø¯Ø®Ù„ Ø¹Ù…Ø± Ø§Ù„Ù…Ø±ÙŠØ¶">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Ø§Ù„Ù‚Ø³Ù…</label>
            <select id="newPatientDept" class="swal2-select">
              <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù‚Ø³Ù…</option>
              <option value="emergency">Ø·ÙˆØ§Ø±Ø¦</option>
              <option value="internal">Ø¨Ø§Ø·Ù†Ø©</option>
              <option value="surgery">Ø¬Ø±Ø§Ø­Ø©</option>
              <option value="pediatrics">Ø£Ø·ÙØ§Ù„</option>
            </select>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ</label>
            <input id="newPatientNid" class="swal2-input" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</label>
            <input id="newPatientAddress" class="swal2-input" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Ø§Ù„Ø£Ù…Ø±Ø§Ø¶</label>
            <input id="newPatientDiseases" class="swal2-input" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø£Ù…Ø±Ø§Ø¶ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Ø§Ù„Ø¯ÙƒØªÙˆØ±</label>
            <input id="newPatientDoctor" class="swal2-input" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ø·Ø¨ÙŠØ¨ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)">
          </div>
        </div>
      `,
      preConfirm: () => {
        const name = document.getElementById("newPatientName").value;
        const age = document.getElementById("newPatientAge").value;
        const department = document.getElementById("newPatientDept").value;
        const nid = document.getElementById("newPatientNid").value;
        const address = document.getElementById("newPatientAddress").value;
        const diseases = document.getElementById("newPatientDiseases").value;
        const doctor = document.getElementById("newPatientDoctor").value;
        
        if (!name || !age || !department || !nid) {
          Swal.showValidationMessage("Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„Ø¹Ù…Ø± ÙˆØ§Ù„Ù‚Ø³Ù… ÙˆØ±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ Ù…Ø·Ù„ÙˆØ¨ÙˆÙ†");
          return false;
        }
        
        const newPatientRef = push(child(dbRef, "patients"));
        return set(newPatientRef, {
          name, age, department, nid, address, diseases, doctors: doctor, timestamp: Date.now()
        });
      }
    }).then(result => {
      if (result.isConfirmed) Swal.fire("ØªÙ…", "ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø±ÙŠØ¶ Ø¨Ù†Ø¬Ø§Ø­", "success");
    });
  },
  
  updateStats() {
    const patientsRef = ref(db, "patients");
    
    get(patientsRef).then((snapshot) => {
      const data = snapshot.val();
      let countPatients = 0;
      let departmentSet = new Set();
      
      if (data) {
        Object.entries(data).forEach(([department, patients]) => {
          departmentSet.add(department);
          countPatients += Object.keys(patients).length;
        });
      }
      
      document.getElementById("totalPatients").textContent = countPatients;
      document.getElementById("totalDepartments").textContent = departmentSet.size;
      
      // ØªØ­Ø¯ÙŠØ« Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø£Ù‚Ø³Ø§Ù…
      const deptStats = document.querySelectorAll(".dept-stat");
      deptStats.forEach(stat => {
        stat.remove();
      });
      
      const statsContainer = document.querySelector(".stats-grid");
      if (statsContainer) {
        Object.entries({
          "emergency": "Ø·ÙˆØ§Ø±Ø¦",
          "internal": "Ø¨Ø§Ø·Ù†Ø©",
          "surgery": "Ø¬Ø±Ø§Ø­Ø©",
          "pediatrics": "Ø£Ø·ÙØ§Ù„"
        }).forEach(([key, name]) => {
          const count = data && data[key] ? Object.keys(data[key]).length : 0;
          const colorClass = key === "emergency" ? "bg-red-100 text-red-800" : 
                           key === "surgery" ? "bg-yellow-100 text-yellow-800" : 
                           "bg-blue-100 text-blue-800";
          
          const statEl = document.createElement("div");
          statEl.className = "dept-stat p-3 rounded border";
          statEl.innerHTML = `
            <div class="flex justify-between items-center">
              <span class="font-semibold">${name}</span>
              <span class="${colorClass} px-2 py-1 rounded-full text-xs font-semibold">${count} Ù…Ø±ÙŠØ¶</span>
            </div>
          `;
          statsContainer.appendChild(statEl);
        });
      }
    });
  }
};

// Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø·Ø¨Ø§Ø¡
const doctorManager = {
  init() {
    this.loadDoctors();
    this.setupEventListeners();
  },
  
  setupEventListeners() {
    document.getElementById("addDoctorBtn").addEventListener("click", () => this.addDoctor());
  },
  
  loadDoctors() {
    const doctorsRef = ref(db, "doctors");
    
    onValue(doctorsRef, (snapshot) => {
      const data = snapshot.val();
      const doctorsContainer = document.getElementById("doctorsContainer");
      doctorsContainer.innerHTML = "";
      
      if (data) {
        // ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ù„Ù‰ Ù…ØµÙÙˆÙØ©
        let allDoctors = [];
        Object.entries(data).forEach(([docId, doc]) => {
          allDoctors.push({ id: docId, ...doc });
        });
        
        // ÙØ±Ø² Ø§Ù„Ø£Ø·Ø¨Ø§Ø¡ Ø­Ø³Ø¨ Ø§Ù„Ø­Ø§Ù„Ø© (Ù…ØªØ§Ø­ÙˆÙ† Ø£ÙˆÙ„Ø§Ù‹)
        allDoctors.sort((a, b) => {
          if (a.manualStatus === b.manualStatus) {
            return a.name.localeCompare(b.name);
          }
          return a.manualStatus === "online" ? -1 : 1;
        });
        
        this.renderDoctors(allDoctors);
      } else {
        doctorsContainer.innerHTML = `
          <div class="text-center py-8 text-gray-500">
            <i class="fas fa-user-md text-4xl mb-3"></i>
            <p>Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø£ÙŠ Ø£Ø·Ø¨Ø§Ø¡ Ù…Ø³Ø¬Ù„ÙŠÙ† Ø­Ø§Ù„ÙŠØ§Ù‹</p>
          </div>
        `;
      }
    });
  },
  
  renderDoctors(doctors) {
    const doctorsContainer = document.getElementById("doctorsContainer");
    
    doctors.forEach(doctor => {
      const doctorCard = document.createElement("div");
      doctorCard.className = "bg-white rounded-lg shadow-md p-4 mb-4 hover:shadow-lg transition-shadow duration-300";
      
      // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù„ÙˆÙ† Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø­Ø§Ù„Ø©
      let statusColor = doctor.manualStatus === "online" ? 
                        "bg-green-100 text-green-800" : 
                        "bg-red-100 text-red-800";
      
      // ØªØ­Ø¯ÙŠØ¯ Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ù‚Ø³Ù…
      let deptIcon = "fas fa-hospital";
      if (doctor.department === "emergency") deptIcon = "fas fa-ambulance";
      else if (doctor.department === "internal") deptIcon = "fas fa-heartbeat";
      else if (doctor.department === "surgery") deptIcon = "fas fa-procedures";
      else if (doctor.department === "pediatrics") deptIcon = "fas fa-child";
      
      doctorCard.innerHTML = `
        <div class="flex justify-between items-start">
          <div class="flex items-center">
            <div class="w-12 h-12 rounded-full bg-blue-100 flex items-center justify-center text-blue-600 mr-4">
              <i class="fas fa-user-md"></i>
            </div>
            <div>
              <h3 class="font-bold text-lg">${doctor.name}</h3>
              <div class="flex items-center text-sm text-gray-600">
                <i class="${deptIcon} mr-1"></i>
                <span>${doctor.department}</span>
              </div>
            </div>
          </div>
          <span class="px-3 py-1 rounded-full text-xs font-semibold ${statusColor}">
            ${doctor.manualStatus === "online" ? "Ù…ØªØ§Ø­" : "ØºÙŠØ± Ù…ØªØ§Ø­"}
          </span>
        </div>
        
        <div class="mt-4 grid grid-cols-2 gap-2 text-sm">
          <div>
            <p class="text-gray-500">Ø§Ù„ÙˆØ±Ø¯ÙŠØ©:</p>
            <p>${doctor.shift}</p>
          </div>
          <div>
            <p class="text-gray-500">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†Ø¶Ù…Ø§Ù…:</p>
            <p>${new Date(doctor.timestamp || Date.now()).toLocaleDateString("ar-EG")}</p>
          </div>
        </div>
        
        <div class="mt-4 flex justify-between items-center">
          <div class="text-sm text-gray-500">
            <i class="far fa-clock mr-1"></i> ${doctor.lastActive ? new Date(doctor.lastActive).toLocaleString("ar-EG") : "ØºÙŠØ± Ù…ØªØµÙ„"}
          </div>
          <div class="flex gap-2">
            <button class="changeStatusBtn ${doctor.manualStatus === "online" ? "bg-red-500" : "bg-green-500"} text-white px-3 py-1 rounded text-sm hover:bg-opacity-90" data-id="${doctor.id}" data-status="${doctor.manualStatus}">
              <i class="fas ${doctor.manualStatus === "online" ? "fa-toggle-off" : "fa-toggle-on"} mr-1"></i> 
              ${doctor.manualStatus === "online" ? "Ø¥Ø®ÙØ§Ø¡" : "Ø¥Ø¸Ù‡Ø§Ø±"}
            </button>
            <button class="editDoctorBtn bg-yellow-500 text-white px-3 py-1 rounded text-sm hover:bg-yellow-600" data-id="${doctor.id}">
              <i class="fas fa-edit mr-1"></i> ØªØ¹Ø¯ÙŠÙ„
            </button>
            <button class="deleteDoctorBtn bg-red-500 text-white px-3 py-1 rounded text-sm hover:bg-red-600" data-id="${doctor.id}">
              <i class="fas fa-trash mr-1"></i> Ø­Ø°Ù
            </button>
          </div>
        </div>
      `;
      
      doctorsContainer.appendChild(doctorCard);
    });
    
    this.attachDoctorEvents();
  },
  
  attachDoctorEvents() {
    // ØªØºÙŠÙŠØ± Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ø¨ÙŠØ¨
    document.querySelectorAll(".changeStatusBtn").forEach(button => {
      button.addEventListener("click", () => {
        const docId = button.dataset.id;
        const currentStatus = button.dataset.status;
        const newStatus = currentStatus === "online" ? "offline" : "online";
        const doctorStatusRef = child(dbRef, `doctors/${docId}`);
        
        update(doctorStatusRef, { 
          manualStatus: newStatus,
          lastActive: Date.now()
        });
      });
    });
    
    // ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø·Ø¨ÙŠØ¨
    document.querySelectorAll(".editDoctorBtn").forEach(button => {
      button.addEventListener("click", () => {
        const docId = button.dataset.id;
        
        get(child(dbRef, `doctors/${docId}`)).then((snapshot) => {
          const doctor = snapshot.val();
          if (doctor) {
            Swal.fire({
              title: "ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ø¨ÙŠØ¨",
              html: `
                <div class="space-y-3 text-right">
                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Ø§Ù„Ø§Ø³Ù…</label>
                    <input id="editDocName" class="swal2-input" value="${doctor.name}">
                  </div>
                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Ø§Ù„Ù‚Ø³Ù…</label>
                    <select id="editDocDept" class="swal2-select">
                      <option value="emergency" ${doctor.department === "emergency" ? "selected" : ""}>Ø·ÙˆØ§Ø±Ø¦</option>
                      <option value="internal" ${doctor.department === "internal" ? "selected" : ""}>Ø¨Ø§Ø·Ù†Ø©</option>
                      <option value="surgery" ${doctor.department === "surgery" ? "selected" : ""}>Ø¬Ø±Ø§Ø­Ø©</option>
                      <option value="pediatrics" ${doctor.department === "pediatrics" ? "selected" : ""}>Ø£Ø·ÙØ§Ù„</option>
                    </select>
                  </div>
                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Ø§Ù„ÙˆØ±Ø¯ÙŠØ©</label>
                    <select id="editDocShift" class="swal2-select">
                      <option value="Morning" ${doctor.shift === "Morning" ? "selected" : ""}>ØµØ¨Ø§Ø­ÙŠ</option>
                      <option value="Evening" ${doctor.shift === "Evening" ? "selected" : ""}>Ù…Ø³Ø§Ø¦ÙŠ</option>
                      <option value="Night" ${doctor.shift === "Night" ? "selected" : ""}>Ù„ÙŠÙ„ÙŠ</option>
                    </select>
                  </div>
                </div>
              `,
              preConfirm: () => {
                const name = document.getElementById("editDocName").value;
                const department = document.getElementById("editDocDept").value;
                const shift = document.getElementById("editDocShift").value;
                
                if (!name || !department || !shift) {
                  Swal.showValidationMessage("ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„");
                  return false;
                }
                
                update(child(dbRef, `doctors/${docId}`), { name, department, shift });
              }
            }).then(result => {
              if (result.isConfirmed) Swal.fire("ØªÙ…", "ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø·Ø¨ÙŠØ¨ Ø¨Ù†Ø¬Ø§Ø­", "success");
            });
          }
        });
      });
    });
    
    // Ø­Ø°Ù Ø§Ù„Ø·Ø¨ÙŠØ¨
    document.querySelectorAll(".deleteDoctorBtn").forEach(button => {
      button.addEventListener("click", () => {
        const docId = button.dataset.id;
        
        Swal.fire({
          title: "Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ØŸ",
          text: "Ø³ÙŠØªÙ… Ø­Ø°Ù Ø§Ù„Ø·Ø¨ÙŠØ¨ Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹",
          icon: "warning",
          showCancelButton: true,
          confirmButtonText: "Ù†Ø¹Ù…ØŒ Ø§Ø­Ø°Ù",
          cancelButtonText: "Ø¥Ù„ØºØ§Ø¡",
          confirmButtonColor: "#ef4444"
        }).then((result) => {
          if (result.isConfirmed) {
            remove(child(dbRef, `doctors/${docId}`))
              .then(() => Swal.fire("ØªÙ…", "ØªÙ… Ø­Ø°Ù Ø§Ù„Ø·Ø¨ÙŠØ¨", "success"))
              .catch(() => Swal.fire("Ø®Ø·Ø£", "ÙØ´Ù„ Ø§Ù„Ø­Ø°Ù", "error"));
          }
        });
      });
    });
  },
  
  addDoctor() {
    Swal.fire({
      title: "Ø¥Ø¶Ø§ÙØ© Ø·Ø¨ÙŠØ¨ Ø¬Ø¯ÙŠØ¯",
      html: `
        <div class="space-y-3 text-right">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Ø§Ù„Ø§Ø³Ù…</label>
            <input id="docName" class="swal2-input" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ø·Ø¨ÙŠØ¨">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Ø§Ù„Ù‚Ø³Ù…</label>
            <select id="docDept" class="swal2-select">
              <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù‚Ø³Ù…</option>
              <option value="emergency">Ø·ÙˆØ§Ø±Ø¦</option>
              <option value="internal">Ø¨Ø§Ø·Ù†Ø©</option>
              <option value="surgery">Ø¬Ø±Ø§Ø­Ø©</option>
              <option value="pediatrics">Ø£Ø·ÙØ§Ù„</option>
            </select>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Ø§Ù„ÙˆØ±Ø¯ÙŠØ©</label>
            <select id="docShift" class="swal2-select">
              <option value="">Ø§Ø®ØªØ± Ø§Ù„ÙˆØ±Ø¯ÙŠØ©</option>
              <option value="Morning">ØµØ¨Ø§Ø­ÙŠ</option>
              <option value="Evening">Ù…Ø³Ø§Ø¦ÙŠ</option>
              <option value="Night">Ù„ÙŠÙ„ÙŠ</option>
            </select>
          </div>
        </div>
      `,
      preConfirm: () => {
        const name = document.getElementById("docName").value;
        const department = document.getElementById("docDept").value;
        const shift = document.getElementById("docShift").value;
        
        if (!name || !department || !shift) {
          Swal.showValidationMessage("ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„");
          return false;
        }
        
        const newDocRef = push(child(dbRef, "doctors"));
        return set(newDocRef, { 
          name, 
          department, 
          shift, 
          manualStatus: "online",
          timestamp: Date.now(),
          lastActive: Date.now()
        });
      }
    }).then(result => {
      if (result.isConfirmed) Swal.fire("ØªÙ…", "ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø·Ø¨ÙŠØ¨ Ø¨Ù†Ø¬Ø§Ø­", "success");
    });
  }
};

// ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
window.addEventListener("DOMContentLoaded", () => {
  setupNavigation();
  patientManager.init();
  doctorManager.init();
});
</script>
</head>
<body class="bg-gray-100 min-h-screen flex">
<!-- Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ -->
<div class="w-64 bg-white shadow-md h-screen p-4">
  <h2 class="text-2xl font-bold mb-6 text-blue-700">Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø¯ÙŠØ±</h2>
  <nav class="flex flex-col gap-2">
    <button class="nav-link px-4 py-2 rounded text-right hover:bg-blue-100" data-target="dashboard">
      <i class="fas fa-home mr-2"></i> Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
    </button>
    <button class="nav-link px-4 py-2 rounded text-right hover:bg-blue-100" data-target="doctors">
      <i class="fas fa-user-md mr-2"></i> Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø·Ø¨Ø§Ø¡
    </button>
    <button class="nav-link px-4 py-2 rounded text-right hover:bg-blue-100" data-target="patients">
      <i class="fas fa-procedures mr-2"></i> Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø±Ø¶Ù‰
    </button>
  </nav>
</div>

<!-- Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
<div class="flex-1 p-6">
  <!-- Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
  <section id="dashboard" class="section">
    <div class="flex items-center mb-6">
      <div class="w-16 h-16 bg-blue-600 rounded-full flex items-center justify-center text-white text-2xl font-bold mr-4">
        <i class="fas fa-user-tie"></i>
      </div>
      <div>
        <h1 class="text-3xl font-bold">Ø£Ù‡Ù„Ø§Ù‹ Ø¨ÙƒØŒ <span class="text-blue-600">Ø¯. Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯</span></h1>
        <p class="text-gray-600">Ù…Ø¯ÙŠØ± Ù…Ø³ØªØ´ÙÙ‰ Ø§Ù„Ù†ÙˆØ± Ø§Ù„ØªØ®ØµØµÙŠ</p>
      </div>
    </div>
    
    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-8 text-center">
      <div class="bg-white shadow-md p-4 rounded">
        <h3 class="text-sm text-gray-500">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø±Ø¶Ù‰</h3>
        <p id="totalPatients" class="text-2xl font-bold text-blue-600">0</p>
      </div>
      <div class="bg-white shadow-md p-4 rounded">
        <h3 class="text-sm text-gray-500">Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…</h3>
        <p id="totalDepartments" class="text-2xl font-bold text-green-600">0</p>
      </div>
      <div class="bg-white shadow-md p-4 rounded">
        <h3 class="text-sm text-gray-500">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙƒØ´ÙˆÙ</h3>
        <p id="totalVisits" class="text-2xl font-bold text-red-600">0</p>
      </div>
    </div>
    
    <div class="bg-white shadow-md rounded p-4 mb-6">
      <h2 class="text-xl font-bold mb-4 text-blue-700">Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø£Ù‚Ø³Ø§Ù…</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div class="border rounded p-3">
          <h3 class="font-bold mb-2">Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ø£Ø·Ø¨Ø§Ø¡</h3>
          <div class="space-y-2">
            <div class="flex justify-between">
              <span>Ø·ÙˆØ§Ø±Ø¦</span>
              <span class="bg-red-100 text-red-800 px-2 py-1 rounded">3 Ø£Ø·Ø¨Ø§Ø¡</span>
            </div>
            <div class="flex justify-between">
              <span>Ø¨Ø§Ø·Ù†Ø©</span>
              <span class="bg-green-100 text-green-800 px-2 py-1 rounded">5 Ø£Ø·Ø¨Ø§Ø¡</span>
            </div>
            <div class="flex justify-between">
              <span>Ø¬Ø±Ø§Ø­Ø©</span>
              <span class="bg-yellow-100 text-yellow-800 px-2 py-1 rounded">4 Ø£Ø·Ø¨Ø§Ø¡</span>
            </div>
            <div class="flex justify-between">
              <span>Ø£Ø·ÙØ§Ù„</span>
              <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded">2 Ø£Ø·Ø¨Ø§Ø¡</span>
            </div>
          </div>
        </div>
        <div class="border rounded p-3">
          <h3 class="font-bold mb-2">Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…Ø±Ø¶Ù‰</h3>
          <div class="space-y-2">
            <div class="flex justify-between">
              <span>Ø·ÙˆØ§Ø±Ø¦</span>
              <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded">12 Ù…Ø±ÙŠØ¶</span>
            </div>
            <div class="flex justify-between">
              <span>Ø¨Ø§Ø·Ù†Ø©</span>
              <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded">24 Ù…Ø±ÙŠØ¶</span>
            </div>
            <div class="flex justify-between">
              <span>Ø¬Ø±Ø§Ø­Ø©</span>
              <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded">18 Ù…Ø±ÙŠØ¶</span>
            </div>
            <div class="flex justify-between">
              <span>Ø£Ø·ÙØ§Ù„</span>
              <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded">9 Ù…Ø±ÙŠØ¶</span>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <div class="bg-white shadow-md rounded p-4">
      <h2 class="text-xl font-bold mb-4 text-blue-700">Ø£Ù‡Ù… Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª</h2>
      <div class="space-y-2">
        <div class="border-l-4 border-yellow-500 p-3 bg-yellow-50">
          <p class="font-bold">Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯</p>
          <p>ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø·Ø¨ÙŠØ¨ Ø¬Ø¯ÙŠØ¯ Ø¥Ù„Ù‰ Ù‚Ø³Ù… Ø§Ù„Ø·ÙˆØ§Ø±Ø¦</p>
          <p class="text-xs text-gray-500">Ù…Ù†Ø° 2 Ø³Ø§Ø¹Ø§Øª</p>
        </div>
        <div class="border-l-4 border-green-500 p-3 bg-green-50">
          <p class="font-bold">Ø­Ø§Ù„Ø© Ù…Ø³ØªÙ‚Ø±Ø©</p>
          <p>Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… ØªØ¹Ù…Ù„ Ø¨ÙƒÙØ§Ø¡Ø© Ø¹Ø§Ù„ÙŠØ©</p>
          <p class="text-xs text-gray-500">Ù…Ù†Ø° 4 Ø³Ø§Ø¹Ø§Øª</p>
        </div>
        <div class="border-l-4 border-red-500 p-3 bg-red-50">
          <p class="font-bold">Ø¹Ø§Ø¬Ù„</p>
          <p>Ø²ÙŠØ§Ø¯Ø© ÙÙŠ Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø±Ø¶Ù‰ ÙÙŠ Ù‚Ø³Ù… Ø§Ù„Ø·ÙˆØ§Ø±Ø¦</p>
          <p class="text-xs text-gray-500">Ù…Ù†Ø° 6 Ø³Ø§Ø¹Ø§Øª</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø·Ø¨Ø§Ø¡ -->
  <section id="doctors" class="section hidden">
    <div class="flex justify-between items-center mb-4">
      <h2 class="text-xl font-bold text-blue-700">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø·Ø¨Ø§Ø¡</h2>
      <div class="flex gap-2">
        <div class="relative">
          <input id="searchDoctor" type="text" placeholder="ğŸ” Ø§Ø¨Ø­Ø« Ø¹Ù† Ø·Ø¨ÙŠØ¨" 
                 class="w-full p-2 pl-10 border rounded">
          <i class="fas fa-search absolute left-3 top-3 text-gray-400"></i>
        </div>
        <button id="addDoctorBtn" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">
          <i class="fas fa-plus mr-2"></i> Ø¥Ø¶Ø§ÙØ© Ø·Ø¨ÙŠØ¨
        </button>
      </div>
    </div>
    
    <div id="doctorsContainer" class="space-y-4">
      <!-- Ø³ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ø·Ø¨Ø§Ø¡ Ù‡Ù†Ø§ -->
    </div>
    
    <!-- Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø£Ø·Ø¨Ø§Ø¡ -->
    <div class="bg-white shadow-md rounded p-4 mt-6">
      <h3 class="text-lg font-bold mb-3 text-blue-700">Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø£Ø·Ø¨Ø§Ø¡</h3>
      <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
        <div class="bg-blue-50 p-3 rounded border border-blue-100">
          <p class="text-sm text-gray-600">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø·Ø¨Ø§Ø¡</p>
          <p id="totalDoctors" class="text-2xl font-bold text-blue-600">0</p>
        </div>
        <div class="bg-green-50 p-3 rounded border border-green-100">
          <p class="text-sm text-gray-600">Ø§Ù„Ø£Ø·Ø¨Ø§Ø¡ Ø§Ù„Ù…ØªØ§Ø­ÙˆÙ†</p>
          <p id="availableDoctors" class="text-2xl font-bold text-green-600">0</p>
        </div>
        <div class="bg-red-50 p-3 rounded border border-red-100">
          <p class="text-sm text-gray-600">Ø§Ù„Ø£Ø·Ø¨Ø§Ø¡ ØºÙŠØ± Ø§Ù„Ù…ØªØ§Ø­ÙŠÙ†</p>
          <p id="unavailableDoctors" class="text-2xl font-bold text-red-600">0</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø±Ø¶Ù‰ -->
  <section id="patients" class="section hidden">
    <h2 class="text-xl font-bold text-blue-700 mb-4">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø±Ø¶Ù‰</h2>
    <div class="relative mb-4">
      <input id="searchPatient" type="text" placeholder="ğŸ” Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ø±ÙŠØ¶" 
             class="w-full p-2 pl-10 border rounded">
      <i class="fas fa-search absolute left-3 top-3 text-gray-400"></i>
    </div>
    
    <div id="patientsContainer" class="space-y-4">
      <!-- Ø³ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø±Ø¶Ù‰ Ù‡Ù†Ø§ -->
    </div>
    
    <!-- Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…Ø±Ø¶Ù‰ -->
    <div class="bg-white shadow-md rounded p-4 mt-6">
      <h3 class="text-lg font-bold mb-3 text-blue-700">Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…Ø±Ø¶Ù‰</h3>
      <div class="stats-grid grid grid-cols-1 md:grid-cols-4 gap-4">
        <div class="bg-blue-50 p-3 rounded border border-blue-100">
          <p class="text-sm text-gray-600">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø±Ø¶Ù‰</p>
          <p id="totalPatientsStat" class="text-2xl font-bold text-blue-600">0</p>
        </div>
        <div class="bg-red-50 p-3 rounded border border-red-100">
          <p class="text-sm text-gray-600">Ø·ÙˆØ§Ø±Ø¦</p>
          <p id="emergencyCount" class="text-2xl font-bold text-red-600">0</p>
        </div>
        <div class="bg-green-50 p-3 rounded border border-green-100">
          <p class="text-sm text-gray-600">Ø¨Ø§Ø·Ù†Ø©</p>
          <p id="internalCount" class="text-2xl font-bold text-green-600">0</p>
        </div>
        <div class="bg-yellow-50 p-3 rounded border border-yellow-100">
          <p class="text-sm text-gray-600">Ø¬Ø±Ø§Ø­Ø©</p>
          <p id="surgeryCount" class="text-2xl font-bold text-yellow-600">0</p>
        </div>
      </div>
    </div>
  </section>
</div>
</body>
</html>
