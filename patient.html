<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ملف المريض - مستشفى الحياة الذكية</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>
</head>
<body class="bg-gray-100 p-4">
  <div class="max-w-5xl mx-auto bg-white rounded-xl shadow-lg p-6">
    <h1 class="text-3xl font-bold text-center text-blue-700 mb-6">ملف المريض</h1>

    <!-- معلومات أساسية -->
    <div class="mb-6">
      <h2 class="text-xl font-semibold mb-2">المعلومات الأساسية</h2>
      <table class="table-auto w-full border border-gray-300 text-center">
        <thead class="bg-gray-200">
          <tr>
            <th>الاسم</th>
            <th>العمر</th>
            <th>الرقم القومي</th>
            <th>ID</th>
            <th>تاريخ الدخول</th>
            <th>القسم الحالي</th>
            <th>الطبيب المعالج</th>
          </tr>
        </thead>
        <tbody id="basic-info">
          <!-- بيانات من قاعدة البيانات -->
        </tbody>
      </table>
    </div>

    <!-- الحالة الحالية -->
    <div class="mb-6">
      <h2 class="text-xl font-semibold mb-2">حالة المريض</h2>
      <div id="status" class="p-4 border rounded bg-green-50">مستقرة</div>
    </div>

    <!-- سجل زيارات -->
    <div class="mb-6">
      <h2 class="text-xl font-semibold mb-2">سجل الزيارات</h2>
      <table class="table-auto w-full border border-gray-300 text-center">
        <thead class="bg-gray-200">
          <tr>
            <th>نوع الزيارة</th>
            <th>ملاحظات الطبيب</th>
            <th>التاريخ</th>
          </tr>
        </thead>
        <tbody id="visit-log">
          <!-- زيارات من قاعدة البيانات -->
        </tbody>
      </table>
    </div>

    <!-- سجل التحويلات -->
    <div class="mb-6">
      <h2 class="text-xl font-semibold mb-2">سجل التحويلات</h2>
      <table class="table-auto w-full border border-gray-300 text-center">
        <thead class="bg-gray-200">
          <tr>
            <th>القسم المحول إليه</th>
            <th>تفاصيل</th>
            <th>التاريخ</th>
          </tr>
        </thead>
        <tbody id="transfer-log">
          <!-- تحويلات من قاعدة البيانات -->
        </tbody>
      </table>
    </div>

    <!-- سجل الأدوية -->
    <div class="mb-6">
      <h2 class="text-xl font-semibold mb-2">سجل الأدوية والعلاج</h2>
      <table class="table-auto w-full border border-gray-300 text-center">
        <thead class="bg-gray-200">
          <tr>
            <th>الدواء</th>
            <th>الجرعة</th>
            <th>ملاحظات</th>
            <th>التاريخ</th>
          </tr>
        </thead>
        <tbody id="medication-log">
          <!-- الأدوية من قاعدة البيانات -->
        </tbody>
      </table>
    </div>

    <!-- QR Code و أزرار -->
    <div class="flex items-center justify-between mt-6">
      <div>
        <h2 class="font-semibold mb-2">QR Code لملف المريض</h2>
        <div id="qrcode" class="bg-white p-2 border rounded"></div>
      </div>

      <div class="space-x-2">
        <button onclick="window.print()" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">تحميل تقرير PDF</button>
        <a href="emergency.html" class="bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600">رجوع إلى قسم الطوارئ</a>
      </div>
    </div>
  </div>

  <script>
    // مثال: تحميل بيانات تجريبية مؤقتاً
    const patient = {
      id: "P12345",
      name: "أحمد عبدالله",
      age: 40,
      nid: "29801123456789",
      date: "2025-07-18",
      department: "الطوارئ",
      doctor: "د. محمود علي",
      status: "مستقرة",
      visits: [
        { type: "كشف طبي", note: "ارتفاع ضغط الدم", date: "2025-07-18" },
        { type: "متابعة", note: "تحسن ملحوظ", date: "2025-07-19" }
      ],
      transfers: [
        { to: "العناية المركزة", details: "احتياج لمتابعة دقيقة", date: "2025-07-19" }
      ],
      medications: [
        { name: "باراسيتامول", dose: "500mg", note: "كل 8 ساعات", date: "2025-07-18" }
      ]
    };

    document.getElementById("basic-info").innerHTML = `
      <tr>
        <td>${patient.name}</td>
        <td>${patient.age}</td>
        <td>${patient.nid}</td>
        <td>${patient.id}</td>
        <td>${patient.date}</td>
        <td>${patient.department}</td>
        <td>${patient.doctor}</td>
      </tr>`;

    document.getElementById("status").innerText = patient.status;

    document.getElementById("visit-log").innerHTML =
      patient.visits.map(v => `<tr><td>${v.type}</td><td>${v.note}</td><td>${v.date}</td></tr>`).join("");

    document.getElementById("transfer-log").innerHTML =
      patient.transfers.map(t => `<tr><td>${t.to}</td><td>${t.details}</td><td>${t.date}</td></tr>`).join("");

    document.getElementById("medication-log").innerHTML =
      patient.medications.map(m => `<tr><td>${m.name}</td><td>${m.dose}</td><td>${m.note}</td><td>${m.date}</td></tr>`).join("");

    // توليد QR Code
    QRCode.toCanvas(document.getElementById("qrcode"), `https://hospital.com/patient/${patient.id}`);
  </script>
</body>
</html>
